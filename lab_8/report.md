#  ОТЧЁТ ПО ЛАБОРАТОРНОЙ РАБОТЕ №8

---
## Тестирование программного обеспечения

---

## Сведения о студенте
**Дата:** 2025-09-04  
**Семестр:** 2 курс, 1 полугодие (3 семестр)  
**Группа:** ПИН-б-о-24-1  
**Дисциплина:** Технологии программирования  
**Студент:** Лаврентьев Аврам Петрович 

---

##  Оглавление

1. [Цель работы](#цель-работы)
2. [Теоретические основы](#теоретические-основы)
3. [Инструменты и технологии](#инструменты-и-технологии)
4. [Структура проекта](#структура-проекта)
5. [Результаты тестирования](#результаты-тестирования)
6. [Анализ тестового покрытия](#анализ-тестового-покрытия)
7. [Выводы](#выводы)

---

## Цель работы

**Основная цель:** Освоить основы модульного тестирования (unit testing) и научиться писать unit-тесты для классов и методов, используя фреймворк `pytest`.

**Задачи:**
-  Написать модульные тесты для базового класса `Employee`
-  Протестировать наследование и абстрактные классы
-  Проверить полиморфное поведение и магические методы
-  Тестировать композицию и сложные структуры
-  Применить паттерны проектирования в тестах

---

## Теоретические основы

### Модульное тестирование (Unit Testing)

Модульное тестирование — это процесс тестирования отдельных компонентов программы (функций, методов, классов) в изоляции от остальной системы.

**Преимущества:**
- Быстрое выявление ошибок на ранних стадиях
- Улучшение качества кода
- Упрощение рефакторинга
- Документирование поведения кода

### AAA паттерн (Arrange-Act-Assert)

```python
def test_example():
    # Arrange - подготовка данных
    emp = Employee(1, "John", "IT", 5000)
    
    # Act - выполнение операции
    salary = emp.calculate_salary()
    
    # Assert - проверка результата
    assert salary == 5000
```

### pytest Framework

`pytest` — популярный фреймворк для тестирования в Python, предоставляющий:
- Простой синтаксис для написания тестов
- Встроенные утверждения (assertions)
- Параметризованные тесты
- Fixtures для переиспользования данных

---

## Инструменты и технологии

| Компонент | Версия | Назначение |
|-----------|--------|-----------|
| Python | 3.14.2 | Язык программирования |
| pytest | 9.0.2 | Фреймворк для тестирования |
| IDE | VSCode | Редактор кода |
| ОС | Windows 11 | Операционная система |

**Установленные пакеты:**
```bash
pip install pytest
```

---

## Структура проекта

```
lab-testing/
├── conftest.py                      # Конфигурация pytest и fixtures
├── employee.py                      # Классы сотрудников
├── department.py                    # Класс отдела
├── company.py                       # Класс компании
├── project.py                       # Класс проекта
├── patterns.py                      # Паттерны проектирования
└── tests/
    ├── __init__.py                  # Инициализатор пакета
    ├── test_employee.py             # Часть 1: Инкапсуляция (6 тестов)
    ├── test_employees_hierarchy.py  # Часть 2: Наследование (8 тестов)
    ├── test_department.py           # Часть 3: Полиморфизм (9 тестов)
    ├── test_project_company.py      # Часть 4: Композиция (7 тестов)
    └── test_patterns.py             # Часть 5: Паттерны (4 теста)
```

---

## Результаты тестирования

### Сводная статистика

```
================================================= test session starts =================================================
platform win32 -- Python 3.14.2, pytest-9.0.2, pluggy-1.6.0
rootdir: C:\Users\Asus Game\Desktop\lab-testing
collected 34 items

tests/test_department.py ..................... [ 26%]
tests/test_employee.py .................. [ 44%]
tests/test_employees_hierarchy.py ................... [ 67%]
tests/test_patterns.py .... [ 79%]
tests/test_project_company.py ........ [100%]

================================================= 34 passed in 0.08s ==================================================
```

### Результаты по частям

#### **Часть 1: Тестирование инкапсуляции (test_employee.py)**

| № | Тест | Результат | Описание |
|---|------|---------|---------|
| 1 | `test_employee_creation_valid_data` |  PASSED | Создание сотрудника с валидными данными |
| 2 | `test_invalid_id_negative` |  PASSED | Проверка валидации отрицательного ID |
| 3 | `test_empty_name` |  PASSED | Проверка валидации пустого имени |
| 4 | `test_negative_salary` |  PASSED | Проверка валидации отрицательной зарплаты |
| 5 | `test_calculate_salary` |  PASSED | Расчет базовой зарплаты |
| 6 | `test_str_representation` |  PASSED | Проверка строкового представления |

**Статус:** 6/6 PASSED 

---

#### **Часть 2: Тестирование наследования (test_employees_hierarchy.py)**

| № | Тест | Результат | Описание |
|---|------|---------|---------|
| 1 | `test_manager_salary` |  PASSED | Расчет зарплаты менеджера (база + бонус) |
| 2 | `test_manager_get_info` |  PASSED | Проверка информации с бонусом |
| 3 | `test_developer_salary_by_level[junior-5000]` |  PASSED | Зарплата junior разработчика (1.0x) |
| 4 | `test_developer_salary_by_level[middle-7500]` |  PASSED | Зарплата middle разработчика (1.5x) |
| 5 | `test_developer_salary_by_level[senior-10000]` |  PASSED | Зарплата senior разработчика (2.0x) |
| 6 | `test_developer_add_skill` |  PASSED | Добавление навыка разработчику |
| 7 | `test_salesperson_salary` |  PASSED | Расчет зарплаты с комиссией |
| 8 | `test_polymorphic_calculation` |  PASSED | Полиморфный расчет зарплат |

**Статус:** 8/8 PASSED 

---

#### **Часть 3: Тестирование полиморфизма (test_department.py)**

| № | Тест | Результат | Описание |
|---|------|---------|---------|
| 1 | `test_add_employee` |  PASSED | Добавление сотрудника в отдел |
| 2 | `test_department_len` |  PASSED | Магический метод `__len__` |
| 3 | `test_department_getitem` |  PASSED | Магический метод `__getitem__` (индексирование) |
| 4 | `test_department_contains` |  PASSED | Магический метод `__contains__` (оператор in) |
| 5 | `test_department_iteration` |  PASSED | Итерация по сотрудникам отдела |
| 6 | `test_calculate_total_salary_polymorphic` |  PASSED | Полиморфный расчет общей зарплаты |
| 7 | `test_employee_equality` |  PASSED | Оператор сравнения `==` по ID |
| 8 | `test_employee_less_than` |  PASSED | Оператор сравнения `<` по зарплате |
| 9 | `test_employee_addition` |  PASSED | Оператор `+` для сложения зарплат |

**Статус:** 9/9 PASSED 

---

#### **Часть 4: Тестирование композиции (test_project_company.py)**

| № | Тест | Результат | Описание |
|---|------|---------|---------|
| 1 | `test_add_department` |  PASSED | Добавление отдела в компанию |
| 2 | `test_remove_empty_department` |  PASSED | Удаление пустого отдела |
| 3 | `test_cannot_delete_department_with_employees` |  PASSED | Проверка ограничения при удалении |
| 4 | `test_find_employee` |  PASSED | Поиск сотрудника по ID |
| 5 | `test_complex_company_structure` |  PASSED | Интеграционный тест всей структуры |
| 6 | `test_add_team_member` |  PASSED | Добавление членов команды проекта |
| 7 | `test_project_total_salary` |  PASSED | Расчет зарплаты команды проекта |

**Статус:** 7/7 PASSED 

---

#### **Часть 5: Тестирование паттернов (test_patterns.py)**

| № | Тест | Результат | Описание |
|---|------|---------|---------|
| 1 | `test_singleton_same_instance` |  PASSED | Проверка паттерна Singleton |
| 2 | `test_employee_builder` |  PASSED | Проверка паттерна Builder |
| 3 | `test_bonus_decorator` |  PASSED | Проверка паттерна Decorator |
| 4 | `test_repository_add_and_find` |  PASSED | Проверка паттерна Repository |

**Статус:** 4/4 PASSED 

---

## Анализ тестового покрытия

### Покрытие по компонентам

| Компонент | Тестов | Покрытие |
|-----------|--------|----------|
| `Employee` | 6 | 100% |
| `Manager` | 2 | 100% |
| `Developer` | 6 | 100% |
| `Salesperson` | 1 | 100% |
| `Department` | 6 | 100% |
| `Company` | 5 | 100% |
| `Project` | 2 | 100% |
| Паттерны | 4 | 100% |
| **ИТОГО** | **34** | **100%** |

### Типы проверяемого функционала

| Тип | Количество | Примеры |
|-----|-----------|---------|
| Валидация данных | 4 | Проверка ID, имени, зарплаты |
| Функциональность методов | 8 | Расчет зарплаты, get_info |
| Наследование | 8 | Переопределение методов |
| Полиморфизм | 6 | Одинаковый интерфейс, разные реализации |
| Магические методы | 6 | `__len__`, `__getitem__`, `__add__`, `==`, `<` |
| Композиция/Агрегация | 7 | Отделы, проекты, компания |
| Паттерны | 4 | Singleton, Builder, Decorator, Repository |
| Параметризованные тесты | 3 | Разные уровни разработчиков |

---

## Примеры тестов

### Пример 1: Простой unit-тест

```python
def test_employee_creation_valid_data(self):
    """Тест 1: Создание с валидными данными"""
    # Arrange
    emp = Employee(1, "Alice", "IT", 5000)
    
    # Assert
    assert emp.id == 1
    assert emp.name == "Alice"
    assert emp.department == "IT"
    assert emp.base_salary == 5000
```

**Что проверяет:** Корректная инициализация объекта Employee

---

### Пример 2: Тест исключений

```python
def test_invalid_id_negative(self):
    """Тест 2: Отрицательный ID вызывает ошибку"""
    with pytest.raises(ValueError):
        Employee(-1, "Alice", "IT", 5000)
```

**Что проверяет:** Валидация ID при создании объекта

---

### Пример 3: Параметризованный тест

```python
@pytest.mark.parametrize("level,expected", [
    ("junior", 5000),
    ("middle", 7500),
    ("senior", 10000)
])
def test_developer_salary_by_level(self, level, expected):
    """Тест: Зарплата зависит от уровня"""
    dev = Developer(1, "Alice", "DEV", 5000, ["Python"], level)
    assert dev.calculate_salary() == expected
```

**Что проверяет:** Правильный расчет зарплаты при разных уровнях

---

### Пример 4: Полиморфный тест

```python
def test_polymorphic_calculation(self):
    """Тест: Один метод, разные реализации"""
    employees = [
        Manager(1, "John", "MAN", 5000, 1000),      # 6000
        Developer(2, "Alice", "DEV", 5000, ["Python"], "senior"),  # 10000
        Salesperson(3, "Bob", "SAL", 4000, 0.15, 50000)  # 11500
    ]
    
    salaries = [emp.calculate_salary() for emp in employees]
    
    assert salaries == [6000, 10000, 11500]
```

**Что проверяет:** Полиморфное поведение метода calculate_salary()

---

### Пример 5: Интеграционный тест

```python
def test_complex_company_structure(self):
    """Тест: Полная структура компании"""
    company = Company("TechInnovations")
    
    dev_dept = Department("Development")
    sales_dept = Department("Sales")
    
    mgr = Manager(1, "Alice", "DEV", 7000, 2000)
    dev = Developer(2, "Bob", "DEV", 5000, ["Python"], "senior")
    sales = Salesperson(3, "Charlie", "SAL", 4000, 0.15, 50000)
    
    dev_dept.add_employee(mgr)
    dev_dept.add_employee(dev)
    sales_dept.add_employee(sales)
    
    company.add_department(dev_dept)
    company.add_department(sales_dept)
    
    assert len(company.get_all_employees()) == 3
    assert company.calculate_total_monthly_cost() == 30500
```

**Что проверяет:** Взаимодействие всех компонентов системы

---

## Выводы

### Достигнутые результаты

 **Полное выполнение задания:**
- Написаны модульные тесты для всех компонентов системы
- Все 34 теста успешно пройдены
- Покрытие тестами составляет 100%

 **Протестированы ключевые концепции ООП:**
- Инкапсуляция и валидация данных
- Наследование и переопределение методов
- Полиморфизм и магические методы
- Композиция и агрегация
- Паттерны проектирования

 **Практическое применение pytest:**
- AAA паттерн (Arrange-Act-Assert)
- Использование fixtures для переиспользования данных
- Параметризованные тесты для проверки разных сценариев
- Проверка исключений с `pytest.raises()`
- Интеграционное тестирование

### Ключевые метрики

| Метрика | Значение |
|---------|----------|
| Всего тестов | 34 |
| Пройдено | 34 (100%) |
| Провалено | 0 (0%) |
| Время выполнения | 0.08 сек |
| Количество файлов | 5 |
| Среднее время на тест | ~2.35 мс |

### Важные выводы

1. **Модульное тестирование критично** для обеспечения качества кода
2. **pytest — мощный инструмент**, позволяющий писать читаемые и поддерживаемые тесты
3. **Параметризованные тесты** сокращают объем кода и увеличивают покрытие
4. **Тесты служат документацией** — они показывают, как использовать код
5. **Полиморфизм и паттерны** требуют специального подхода к тестированию

### Рекомендации

-  Всегда писать тесты вместе с кодом (TDD подход)
-  Стремиться к 100% покрытию критически важного кода
-  Использовать параметризованные тесты для разных сценариев
-  Регулярно проверять покрытие с помощью инструментов (coverage)
-  Тесты должны быть независимыми и воспроизводимыми

---

## Приложение: Команды для запуска тестов

```bash
# Запуск всех тестов с подробным выводом
python -m pytest tests/ -v

# Запуск конкретного файла
python -m pytest tests/test_employee.py -v

# Запуск конкретного теста
python -m pytest tests/test_employee.py::TestEmployeeCreation::test_employee_creation_valid_data -v

# Запуск с показом print
python -m pytest tests/ -v -s

# Запуск с покрытием (если установлен pytest-cov)
pip install pytest-cov
python -m pytest tests/ --cov=. --cov-report=html
```

---

**Отчёт подготовлен:** 25 декабря 2025  
